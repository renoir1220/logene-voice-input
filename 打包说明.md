# 打包说明

## 前置条件

- Python 3.13（`C:\Python313\python.exe`）
- Node.js + npm

## 打包步骤

### 1. 关闭正在运行的 asr_server（如果有）

```
taskkill /F /IM asr_server.exe
```

### 2. 构建 sidecar

```
python python/build_sidecar.py
```

首次运行会自动创建 `python/.venv` 并安装所有依赖（需要联网，约 5 分钟）。
后续运行直接跳过 venv 初始化。

### 3. 构建 Electron + 打包安装包

```
npx electron-vite build && npx electron-builder --win
```

输出文件：`dist/朗珈语音输入法 Setup x.x.x.exe`

---

## 注意事项

- 打包前必须关闭 asr_server 进程，否则 PyInstaller 无法覆盖旧文件（PermissionError）
- `python/.venv` 不进 git，换机器后首次打包会自动重建
- `funasr-onnx` 用 `--no-deps` 安装以绕过 `numpy<=1.26.4` 的版本约束（Python 3.13 上无法编译旧版 numpy）
