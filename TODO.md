# TODO

## Focus Recovery Rebuild

- [x] 全面排查并按最佳实践重构焦点恢复链路，移除临时补丁式代码，保持实现简洁可维护。
- [x] 去掉渲染层多次 `reinforceFocus` 补丁（0/80/180ms 反复 restore），改为主进程单点恢复。
- [x] 去掉 `pointerDownPrevAppId/manualPrevAppId` 双状态并发竞态，改为“单一焦点快照”来源。
- [x] 将权限提示从焦点热路径中移除（不在焦点快照/恢复函数中触发弹窗），避免录音过程中抢焦点。
- [x] 统一为主进程 FocusController：负责快照、恢复、重试和校验，渲染层改走单一 `capture-focus-snapshot` 通道。
- [ ] 焦点保持问题是否彻底解决（需用户侧真实应用场景验证）。
- [ ] 复核 VAD 按钮、录音按钮、热键、重写窗口四条交互链路对焦点的副作用，消除跨功能相互干扰。
- [ ] 建立焦点回归用例矩阵（手动录音、VAD 自动触发、热键录音、双击开面板、拖拽悬浮球）并固化日志断言。
